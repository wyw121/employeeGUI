<!DOCTYPE html>
<html>
<head>
    <title>Tauri å‘½ä»¤æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 3px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 3px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Tauri æ–°å¢å‘½ä»¤æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>å‘½ä»¤æµ‹è¯•</h2>
        <button onclick="testAdbStartActivity()">æµ‹è¯• adb_start_activity</button>
        <button onclick="testAdbOpenContacts()">æµ‹è¯• adb_open_contacts_app</button>
        <button onclick="testAdbViewFile()">æµ‹è¯• adb_view_file</button>
        <button onclick="testAllCommands()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
        <button onclick="clearResults()">æ¸…ç©ºç»“æœ</button>
    </div>

    <div id="results"></div>

    <script>
        // æ£€æŸ¥æ˜¯å¦åœ¨ Tauri ç¯å¢ƒä¸­
        function isTauriEnvironment() {
            return typeof window.__TAURI__ !== 'undefined';
        }

        function logResult(message, isSuccess = true) {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `test-result ${isSuccess ? 'success' : 'error'}`;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            results.appendChild(div);
            console.log(message);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        // æµ‹è¯• adb_start_activity å‘½ä»¤
        async function testAdbStartActivity() {
            if (!isTauriEnvironment()) {
                logResult('âŒ ä¸åœ¨ Tauri ç¯å¢ƒä¸­ï¼Œæ— æ³•æµ‹è¯•', false);
                return;
            }

            try {
                logResult('ğŸ”„ æµ‹è¯• adb_start_activity å‘½ä»¤...');
                const result = await window.__TAURI__.tauri.invoke('adb_start_activity', {
                    deviceId: 'test_device',
                    packageName: 'com.android.settings',
                    activityName: 'com.android.settings.Settings'
                });
                logResult(`âœ… adb_start_activity å‘½ä»¤æˆåŠŸ: ${JSON.stringify(result)}`);
            } catch (error) {
                logResult(`âŒ adb_start_activity å‘½ä»¤å¤±è´¥: ${error.message || error}`, false);
            }
        }

        // æµ‹è¯• adb_open_contacts_app å‘½ä»¤
        async function testAdbOpenContacts() {
            if (!isTauriEnvironment()) {
                logResult('âŒ ä¸åœ¨ Tauri ç¯å¢ƒä¸­ï¼Œæ— æ³•æµ‹è¯•', false);
                return;
            }

            try {
                logResult('ğŸ”„ æµ‹è¯• adb_open_contacts_app å‘½ä»¤...');
                const result = await window.__TAURI__.tauri.invoke('adb_open_contacts_app', {
                    deviceId: 'test_device'
                });
                logResult(`âœ… adb_open_contacts_app å‘½ä»¤æˆåŠŸ: ${JSON.stringify(result)}`);
            } catch (error) {
                logResult(`âŒ adb_open_contacts_app å‘½ä»¤å¤±è´¥: ${error.message || error}`, false);
            }
        }

        // æµ‹è¯• adb_view_file å‘½ä»¤
        async function testAdbViewFile() {
            if (!isTauriEnvironment()) {
                logResult('âŒ ä¸åœ¨ Tauri ç¯å¢ƒä¸­ï¼Œæ— æ³•æµ‹è¯•', false);
                return;
            }

            try {
                logResult('ğŸ”„ æµ‹è¯• adb_view_file å‘½ä»¤...');
                const result = await window.__TAURI__.tauri.invoke('adb_view_file', {
                    deviceId: 'test_device',
                    filePath: '/sdcard/test.vcf'
                });
                logResult(`âœ… adb_view_file å‘½ä»¤æˆåŠŸ: ${JSON.stringify(result)}`);
            } catch (error) {
                logResult(`âŒ adb_view_file å‘½ä»¤å¤±è´¥: ${error.message || error}`, false);
            }
        }

        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        async function testAllCommands() {
            logResult('ğŸš€ å¼€å§‹æ‰§è¡Œæ‰€æœ‰å‘½ä»¤æµ‹è¯•...');
            await testAdbStartActivity();
            await new Promise(resolve => setTimeout(resolve, 500)); // çŸ­æš‚å»¶è¿Ÿ
            await testAdbOpenContacts();
            await new Promise(resolve => setTimeout(resolve, 500));
            await testAdbViewFile();
            logResult('âœ¨ æ‰€æœ‰æµ‹è¯•æ‰§è¡Œå®Œæ¯•ï¼');
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºç¯å¢ƒä¿¡æ¯
        window.addEventListener('load', function() {
            if (isTauriEnvironment()) {
                logResult('âœ… æ£€æµ‹åˆ° Tauri ç¯å¢ƒï¼Œå¯ä»¥è¿›è¡Œå‘½ä»¤æµ‹è¯•');
            } else {
                logResult('âš ï¸ æœªæ£€æµ‹åˆ° Tauri ç¯å¢ƒï¼Œè¯·åœ¨ Tauri åº”ç”¨ä¸­æ‰“å¼€æ­¤é¡µé¢', false);
            }
        });
    </script>
</body>
</html>