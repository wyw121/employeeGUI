/**
 * æµ‹è¯•ä¿®å¤åçš„æ£€æµ‹å™¨
 */

const xmlContent = `<?xml version='1.0' encoding='UTF-8' standalone='yes' ?><hierarchy rotation="0"><node index="0" text="" resource-id="" class="android.widget.FrameLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[0,813][720,1484]"><node index="0" text="" resource-id="" class="android.widget.FrameLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,813][696,1484]"><node index="0" text="" resource-id="android:id/content" class="android.widget.FrameLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,813][696,1484]"><node index="0" text="" resource-id="android:id/parentPanel" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,813][696,1484]"><node index="0" text="" resource-id="android:id/topPanel" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,813][696,939]"><node index="0" text="" resource-id="android:id/title_template" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,813][696,939]"><node index="0" text="ä½¿ç”¨ä»¥ä¸‹æ–¹å¼æ‰“å¼€" resource-id="android:id/alertTitle" class="android.widget.TextView" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[72,845][648,907]" /></node></node><node index="1" text="" resource-id="android:id/customPanel" class="android.widget.FrameLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,939][696,1484]"><node index="0" text="" resource-id="android:id/custom" class="android.widget.FrameLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,939][696,1484]"><node index="0" text="" resource-id="com.hihonor.android.internal.app:id/contentPanel" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,939][696,1484]"><node index="0" text="" resource-id="" class="android.widget.ScrollView" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="true" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,955][696,1372]"><node index="0" text="" resource-id="" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,955][696,1372]"><node index="1" text="" resource-id="com.hihonor.android.internal.app:id/normal_profile_layout" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,955][696,1372]"><node index="0" text="" resource-id="" class="android.widget.FrameLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,955][696,1372]"><node index="0" text="" resource-id="" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,955][696,1372]"><node index="0" text="" resource-id="" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="true" bounds="[285,955][435,1105]"><node NAF="true" index="0" text="" resource-id="" class="android.widget.ImageView" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="true" enabled="true" focusable="true" focused="false" scrollable="false" long-clickable="true" password="false" selected="true" bounds="[296,966][424,1094]" /></node><node index="1" text="è”ç³»äºº" resource-id="" class="android.widget.TextView" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[304,1121][415,1172]" /><node index="2" text="ä½¿ç”¨å…¶ä»–åº”ç”¨" resource-id="" class="android.widget.TextView" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[276,1204][444,1242]" /><node index="3" text="" resource-id="" class="android.widget.GridView" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="true" password="false" selected="false" bounds="[48,1258][672,1368]"><node index="0" text="" resource-id="" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[48,1258][352,1368]"><node index="0" text="" resource-id="" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[168,1258][232,1322]"><node index="0" text="" resource-id="" class="android.widget.ImageView" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[176,1266][224,1314]" /></node><node index="1" text="é˜…è¯»" resource-id="android:id/text1" class="android.widget.TextView" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[56,1326][344,1368]" /></node><node index="1" text="" resource-id="" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[368,1258][672,1368]"><node index="0" text="" resource-id="" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[488,1258][552,1322]"><node index="0" text="" resource-id="" class="android.widget.ImageView" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[496,1266][544,1314]" /></node><node index="1" text="ä¿å­˜åˆ°ç½‘ç›˜" resource-id="android:id/text1" class="android.widget.TextView" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[376,1326][664,1368]" /></node></node></node></node></node></node></node><node index="1" text="" resource-id="android:id/button_bar" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,1372][696,1484]"><node index="0" text="" resource-id="" class="android.widget.LinearLayout" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="false" enabled="true" focusable="false" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[24,1392][696,1484]"><node index="0" text="ä»…æ­¤ä¸€æ¬¡" resource-id="android:id/button_once" class="android.widget.Button" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="true" enabled="true" focusable="true" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[48,1400][359,1484]" /><node index="1" text="å§‹ç»ˆ" resource-id="android:id/button_always" class="android.widget.Button" package="com.hihonor.android.internal.app" content-desc="" checkable="false" checked="false" clickable="true" enabled="true" focusable="true" focused="false" scrollable="false" long-clickable="false" password="false" selected="false" bounds="[361,1400][672,1484]" /></node></node></node></node></node></node></node></node></node></hierarchy>`;

console.log('ğŸ§ª æµ‹è¯•ä¿®å¤åçš„æ£€æµ‹é€»è¾‘...');

// æ¨¡æ‹Ÿæ£€æµ‹å™¨çš„extractOnceButtonæ–¹æ³•
function testExtractOnceButton(xmlContent, onceButtonId) {
  console.log(`ğŸ” æŸ¥æ‰¾"ä»…æ­¤ä¸€æ¬¡"æŒ‰é’®...`);
  
  // ç¬¬ä¸€æ­¥ï¼šæ‰¾åˆ°åŒ…å«ç›®æ ‡resource-idå’Œtextçš„node
  const nodePattern = `<node[^>]*resource-id="${onceButtonId}"[^>]*text="ä»…æ­¤ä¸€æ¬¡"[^>]*>`;
  const altNodePattern = `<node[^>]*text="ä»…æ­¤ä¸€æ¬¡"[^>]*resource-id="${onceButtonId}"[^>]*>`;
  
  let nodeMatch = xmlContent.match(new RegExp(nodePattern, 'i'));
  if (!nodeMatch) {
    nodeMatch = xmlContent.match(new RegExp(altNodePattern, 'i'));
  }
  
  if (!nodeMatch) {
    console.log(`âŒ æœªæ‰¾åˆ°åŒ¹é…çš„èŠ‚ç‚¹`);
    return null;
  }
  
  const fullNode = nodeMatch[0];
  console.log(`âœ… æ‰¾åˆ°èŠ‚ç‚¹: ${fullNode.substring(0, 100)}...`);
  
  // ç¬¬äºŒæ­¥ï¼šä»æ‰¾åˆ°çš„èŠ‚ç‚¹ä¸­æå–å„ä¸ªå±æ€§
  const boundsMatch = fullNode.match(/bounds="([^"]*)"/i);
  const classMatch = fullNode.match(/class="([^"]*)"/i);
  const clickableMatch = fullNode.match(/clickable="([^"]*)"/i);
  
  if (!boundsMatch) {
    console.log(`âŒ æœªæ‰¾åˆ°boundså±æ€§`);
    return null;
  }
  
  if (!clickableMatch || clickableMatch[1] !== 'true') {
    console.log(`âŒ æŒ‰é’®ä¸å¯ç‚¹å‡»`);
    return null;
  }
  
  const result = {
    resourceId: onceButtonId,
    text: "ä»…æ­¤ä¸€æ¬¡",
    bounds: boundsMatch[1],
    className: classMatch ? classMatch[1] : "android.widget.Button",
    clickable: true
  };
  
  console.log(`âœ… æˆåŠŸæå–æŒ‰é’®ä¿¡æ¯:`, result);
  return result;
}

const result = testExtractOnceButton(xmlContent, 'android:id/button_once');

if (result) {
  console.log('\nğŸ‰ æ£€æµ‹å™¨ä¿®å¤æˆåŠŸï¼');
  console.log('ç°åœ¨åº”è¯¥èƒ½æ­£å¸¸æ£€æµ‹åˆ°åº”ç”¨é€‰æ‹©å™¨å¯¹è¯æ¡†äº†ã€‚');
  
  // è®¡ç®—boundsä¸­å¿ƒç‚¹
  const bounds = result.bounds; // [48,1400][359,1484]
  const boundsMatch = bounds.match(/\[(\d+),(\d+)\]\[(\d+),(\d+)\]/);
  if (boundsMatch) {
    const x1 = parseInt(boundsMatch[1]);
    const y1 = parseInt(boundsMatch[2]);
    const x2 = parseInt(boundsMatch[3]);
    const y2 = parseInt(boundsMatch[4]);
    const centerX = Math.floor((x1 + x2) / 2);
    const centerY = Math.floor((y1 + y2) / 2);
    console.log(`ğŸ“ æŒ‰é’®ä¸­å¿ƒç‚¹: (${centerX}, ${centerY})`);
  }
} else {
  console.log('\nâŒ æ£€æµ‹å™¨ä»æœ‰é—®é¢˜éœ€è¦è¿›ä¸€æ­¥ä¿®å¤');
}